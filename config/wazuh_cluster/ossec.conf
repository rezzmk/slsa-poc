<ossec_config>
  <!-- Command definitions -->
  <command>
    <name>block-attacker</name>
    <executable>block-attacker.sh</executable>
    <expect>srcip</expect>
    <timeout_allowed>yes</timeout_allowed>
  </command>

  <command>
    <name>trigger-mtd</name>
    <executable>trigger-mtd.sh</executable>
    <expect>srcip</expect>
    <timeout_allowed>yes</timeout_allowed>
  </command>

  <command>
    <name>notify-incident</name>
    <executable>notify-incident.sh</executable>
    <expect>srcip</expect>
    <timeout_allowed>no</timeout_allowed>
  </command>

  <!-- Active Response setup -->
  <!-- DDoS Responses -->
  <active-response>
    <command>block-attacker</command>
    <location>local</location>
    <rules_id>200001,200002,200003,200004</rules_id>
    <timeout>600</timeout> <!-- 10 minutes -->
  </active-response>

  <active-response>
    <command>trigger-mtd</command>
    <location>local</location>
    <rules_id>200001,200002</rules_id>
    <timeout>0</timeout>
  </active-response>

  <!-- APT Responses -->
  <active-response>
    <command>block-attacker</command>
    <location>local</location>
    <rules_id>200100,200101,200102,200103,200104,200105</rules_id>
    <timeout>3600</timeout> <!-- 1 hour -->
  </active-response>

  <active-response>
    <command>notify-incident</command>
    <location>local</location>
    <rules_id>200100,200101,200102,200103,200104,200105</rules_id>
  </active-response>

  <!-- Network Scanning Responses -->
  <active-response>
    <command>block-attacker</command>
    <location>local</location>
    <rules_id>200200,200201,200202,200203,200204,200205</rules_id>
    <timeout>1800</timeout> <!-- 30 minutes -->
  </active-response>

  <active-response>
    <command>trigger-mtd</command>
    <location>local</location>
    <rules_id>200204,200205</rules_id> <!-- Only for coordinated/persistent scanning -->
    <timeout>0</timeout>
  </active-response>
</ossec_config>
