<!-- /var/ossec/etc/rules/custom_app_rules.xml -->
<group name="application,">
  <!-- Base application log rule -->
  <rule id="100300" level="0">
    <decoded_as>json</decoded_as>
    <field name="app_name">ssle-service</field>
    <description>SSLE Service Log</description>
  </rule>

  <!-- Authentication failures -->
  <rule id="100301" level="5">
    <if_sid>100300</if_sid>
    <field name="event_type">authentication_failure</field>
    <description>Authentication failure from IP: $(srcip)</description>
    <group>authentication_failure,</group>
  </rule>

  <!-- Multiple auth failures -->
  <rule id="100302" level="10">
    <if_sid>100301</if_sid>
    <frequency>5</frequency>
    <timeframe>120</timeframe>
    <description>Multiple authentication failures from same IP: $(srcip)</description>
    <group>authentication_failures,brute_force,</group>
  </rule>

  <!-- Suspicious requests -->
  <rule id="100303" level="7">
    <if_sid>100300</if_sid>
    <field name="request_path">.*(\.\.\/|%2e%2e%2f|etc\/passwd|wp-admin|\.env).*</field>
    <description>Suspicious request pattern detected from IP: $(srcip)</description>
    <group>web_scan,recon,</group>
  </rule>

  <!-- Rate limiting exceeded -->
  <rule id="100304" level="8">
    <if_sid>100300</if_sid>
    <field name="event_type">rate_limit_exceeded</field>
    <description>Rate limiting exceeded for IP: $(srcip)</description>
    <group>rate_limit,</group>
  </rule>
</group>
